(this["webpackJsonpnear-storage-basic"]=this["webpackJsonpnear-storage-basic"]||[]).push([[0],{102:function(e,t){},133:function(e,t,n){},134:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(67),c=n(63),i=n(66),s=n(14),l=(n(42),n(7)),u=n(1);function d(e){var t=e.onSubmit;return Object(u.jsx)("form",{children:Object(u.jsx)("button",{type:"button",name:"deposit",onClick:function(e){e.preventDefault(),t()},children:"Deposit"})})}function b(){return Object(u.jsxs)("div",{children:[Object(u.jsxs)("p",{children:["This app demonstrates the client-side usage of"," ",Object(u.jsx)("a",{href:"https://near.storage",target:"_blank",rel:"noreferrer",children:"the NEAR to Filecoin bridge"}),", allowing"," ",Object(u.jsx)("a",{href:"https://near.org",target:"_blank",rel:"noreferrer",children:"NEAR"})," ","users to store data on the"," ",Object(u.jsx)("a",{href:"https://filecoin.io",target:"_blank",rel:"noreferrer",children:"Filecoin"})," ","network."]}),Object(u.jsxs)("p",{children:['This is version 0 of the demo app. You can deposit and release funds, query for the status of a "file" or deal, and more. This is a beta release demo, do not store personal, encrypted, or illegal data. Data will not be available permanently on either Filecoin or IPFS. See the'," ",Object(u.jsx)("a",{href:"https://near.storage/terms",target:"_blank",rel:"noreferrer",children:"terms of service"})," ","before using the demo."]}),Object(u.jsx)("p",{children:"Go ahead and sign in to try it out!"})]})}function h(e){var t=e.inProgress,n=e.onSubmit,r=Object(l.useState)(),o=Object(s.a)(r,2),a=o[0],c=o[1];return Object(u.jsx)("form",{children:Object(u.jsxs)("fieldset",{id:"fieldset",children:[Object(u.jsx)("input",{type:"file",name:"file",onChange:function(e){e.target.files&&c(e.target.files[0])}}),Object(u.jsx)("button",{type:"button",name:"upload",className:!0===t?"loading":"",onClick:function(e){e.preventDefault(),a&&n(a),c(void 0)},children:"Upload"})]})})}var p=n(21),j=function(e){var t=e.wallet,n=e.api,r=Object(l.useState)([]),o=Object(s.a)(r,2),a=o[0],c=o[1],j=Object(l.useState)(!1),f=Object(s.a)(j,2),O=f[0],g=f[1],m=Object(l.useState)(!1),w=Object(s.a)(m,2),x=w[0],v=w[1];Object(l.useEffect)((function(){t.isSignedIn()&&n.hasDeposit().then(v)}),[t,n]);var S=t.getAccountId();return Object(u.jsxs)("main",{children:[Object(u.jsxs)("header",{children:[Object(u.jsx)("h1",{children:"Textile \u24c3ear Storage Demo"}),S?Object(u.jsx)("button",{onClick:function(){t.signOut(),window.location.replace(window.location.origin+window.location.pathname)},children:"Log out"}):Object(u.jsx)("button",{onClick:function(){Object(p.b)(t,{})},children:"Log in"})]}),Object(u.jsx)("p",{children:x?"You got \u24c3 in here!":"Deposit some funds, ".concat(S,"!")}),S?Object(u.jsxs)("div",{children:[Object(u.jsx)(d,{onSubmit:function(){n.addDeposit().then((function(){return v(!0)})).catch((function(e){return alert(e.message)}))}}),x?Object(u.jsx)(h,{onSubmit:function(e){g(!0),n.store(e).then((function(e){c([].concat(Object(i.a)(a),[e])),g(!1),alert("IPFS CID:\n".concat(e.cid["/"]))})).catch((function(e){g(!1),alert(e.message)}))},inProgress:O}):null,Object(u.jsx)("button",{type:"button",name:"release",onClick:function(e){e.preventDefault(),n.releaseDeposits().then((function(){alert("if your session is over, your funds should be returned"),window.location.reload()})).catch((function(e){return alert(e.message)}))},children:"Release"}),Object(u.jsx)("br",{}),a&&Object(u.jsx)("h2",{children:"Your uploads"}),a.map((function(e){return Object(u.jsxs)("p",{children:[e.cid["/"],Object(u.jsx)("br",{}),Object(u.jsx)("button",{type:"button",name:"copy",onClick:function(t){t.preventDefault(),navigator.clipboard.writeText(e.cid["/"])},children:"Copy CID"}),Object(u.jsx)("button",{type:"button",name:"status",onClick:function(t){var r;t.preventDefault(),(r=e.id)?n.status(r).then((function(e){var t=e.request;alert('Filecoin deal status: "'.concat(t.status_code,'"!'))})).catch((function(e){return alert(e.message)})):console.warn("no 'active' file, upload a file first")},children:"Status"}),Object(u.jsx)("br",{})]})}))]}):Object(u.jsx)(b,{})]})},f=n(64),O=n.n(f),g=n(65),m=n.n(g),w=n(10),x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,135)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),a(e),c(e)}))},v=(n(133),Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}));function S(){return(S=Object(c.a)(o.a.mark((function e(){var t,n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m()(v.NODE_ENV||"testnet"),e.next=3,Object(w.connect)(Object(a.a)({deps:{keyStore:new w.keyStores.BrowserLocalStorageKeyStore}},t));case 3:return n=e.sent,r=new w.WalletConnection(n,null),e.next=7,Object(p.b)(r);case 7:return e.next=9,Object(p.a)(r.account(),{provider:"bridge-provider.testnet",registry:"bridge-registry.testnet"});case 9:return c=e.sent,e.abrupt("return",{api:c,wallet:r});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return S.apply(this,arguments)})().then((function(e){var t=e.api,n=e.wallet;O.a.render(Object(u.jsx)(j,{api:t,wallet:n}),document.getElementById("root"))})),x()},65:function(e,t){var n=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}),r=n.CONTRACT_NAME||"filecoin-bridge.testnet";e.exports=function(e){switch(e){case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:r,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org"};case"production":case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:r,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:r,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(n.HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:r};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:r,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:r,masterAccount:"test.near"};default:throw Error("Misconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},75:function(e,t){},85:function(e,t){}},[[134,1,2]]]);
//# sourceMappingURL=main.1927aacf.chunk.js.map