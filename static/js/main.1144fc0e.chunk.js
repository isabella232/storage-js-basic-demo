(this["webpackJsonpnear-storage-basic-demo"]=this["webpackJsonpnear-storage-basic-demo"]||[]).push([[0],{103:function(t,e){},119:function(t,e){},121:function(t,e){},139:function(t,e){},170:function(t,e,n){},171:function(t,e,n){"use strict";n.r(e);var r=n(2),c=n.n(r),o=n(87),a=n(83),i=n(86),s=n(24),u=(n(48),n(9)),l=n(0);function d(t){var e=t.onSubmit;return Object(l.jsx)("form",{children:Object(l.jsx)("button",{type:"button",name:"deposit",onClick:function(t){t.preventDefault(),e()},children:"Deposit"})})}function p(){return Object(l.jsxs)("div",{children:[Object(l.jsx)("p",{children:"This app demonstrates the client-size usage of Textile's deposit mechanism for storing Filecoin data from the Near Blockchain."}),Object(l.jsx)("p",{children:'This is version 0 of the demo app. You can deposit and release funds, query for the status of a "file" or deal, and more.'}),Object(l.jsx)("p",{children:"Go ahead and sign in to try it out!"})]})}function h(t){var e=t.onSubmit,n=Object(u.useState)(),r=Object(s.a)(n,2),c=r[0],o=r[1];return Object(l.jsx)("form",{children:Object(l.jsxs)("fieldset",{id:"fieldset",children:[Object(l.jsx)("input",{type:"file",name:"file",onChange:function(t){t.target.files&&o(t.target.files[0])}}),Object(l.jsx)("button",{type:"button",name:"upload",onClick:function(t){t.preventDefault(),c&&e(c),o(void 0)},children:"Upload"})]})})}var b=n(34),f=function(t){var e=t.api,n=t.currentUser,r=Object(u.useState)([]),c=Object(s.a)(r,2),o=c[0],a=c[1],f=Object(u.useState)(!1),j=Object(s.a)(f,2),O=j[0],m=j[1];Object(u.useEffect)((function(){n&&e.hasDeposit().then(m)}),[n,e]);var g=n&&n.accountId;return Object(l.jsxs)("main",{children:[Object(l.jsxs)("header",{children:[Object(l.jsx)("h1",{children:"Textile Near Storage Demo"}),g?Object(l.jsx)("button",{onClick:function(){e.signOut(),window.location.replace(window.location.origin+window.location.pathname)},children:"Log out"}):Object(l.jsx)("button",{onClick:function(){e.requestSignIn("Textile Near Storage Demo")},children:"Log in"})]}),Object(l.jsx)("p",{children:O?"You got \u24c3 in here!":"Deposit some funds, ".concat(g,"!")}),g?Object(l.jsxs)("div",{children:[Object(l.jsx)(d,{onSubmit:function(){e.addDeposit().then((function(){return m(!0)})).catch((function(t){return alert(t.message)}))}}),O?Object(l.jsx)(h,{onSubmit:function(t){e.store(t).then((function(t){var e={id:t.id,cid:t.cid["/"]};a([].concat(Object(i.a)(o),[e])),alert("Your file is already on IPFS:\n".concat(e.cid))})).catch((function(t){return alert(t.message)}))}}):null,Object(l.jsx)("button",{type:"button",name:"release",onClick:function(t){t.preventDefault(),e.releaseDeposits().then((function(){alert("check your wallet in case of released funds"),window.location.reload()})).catch((function(t){return alert(t.message)}))},children:"Release"}),Object(l.jsx)("br",{}),o&&Object(l.jsx)("h2",{children:"Your uploads"}),o.map((function(t){return Object(l.jsxs)("p",{children:[t.cid,Object(l.jsx)("br",{}),Object(l.jsx)("button",{type:"button",name:"copy",onClick:function(e){e.preventDefault(),navigator.clipboard.writeText(t.cid)},children:"Copy CID"}),Object(l.jsx)("button",{type:"button",name:"status",onClick:function(n){var r;n.preventDefault(),(r=t.id)?e.status(r).then((function(t){alert('Your file status is currently: "'.concat(b.RequestStatus[t.status_code],'"!'))})):console.warn("no 'active' file, upload a file first")},children:"Status"}),Object(l.jsx)("br",{})]})}))]}):Object(l.jsx)(p,{})]})},j=n(84),O=n.n(j),m=n(85),g=n.n(m),x=n(23),w=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,172)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),r(t),c(t),o(t),a(t)}))},S=(n(170),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}));function v(){return(v=Object(a.a)(c.a.mark((function t(){var e,n,r,a,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=g()(S.NODE_ENV||"testnet"),t.next=3,Object(x.connect)(Object(o.a)({deps:{keyStore:new x.keyStores.BrowserLocalStorageKeyStore}},e));case 3:return n=t.sent,r=new x.WalletConnection(n,null),t.next=7,Object(b.init)(r);case 7:if(a=t.sent,!r.getAccountId()){t.next=14;break}return t.t0=r.getAccountId(),t.next=12,r.account().state();case 12:t.t1=t.sent.amount,i={accountId:t.t0,balance:t.t1};case 14:return t.abrupt("return",{currentUser:i,api:a});case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}window.nearInitPromise=function(){return v.apply(this,arguments)}().then((function(t){var e=t.api,n=t.currentUser;O.a.render(Object(l.jsx)(f,{api:e,currentUser:n}),document.getElementById("root"))})),w()},85:function(t,e){var n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}),r=n.CONTRACT_NAME||"filecoin-bridge.testnet";t.exports=function(t){switch(t){case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:r,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org"};case"production":case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:r,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:r,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(n.HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:r};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:r,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:r,masterAccount:"test.near"};default:throw Error("Misconfigured environment '".concat(t,"'. Can be configured in src/config.js."))}}},97:function(t,e){}},[[171,1,2]]]);
//# sourceMappingURL=main.1144fc0e.chunk.js.map